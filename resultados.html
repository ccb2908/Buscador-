<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Resultados ‚Äî ¬°Lupa!</title>
  <link rel="stylesheet" href="style.css" />

  <style>
    .top-bar {
      padding: 16px;
      border-bottom: 1px solid #ddd;
      background: #fff;
    }

    .search-inline {
      display: flex;
      gap: 8px;
      justify-content: center;
    }

    .search-inline input {
      width: 260px;
      padding: 10px 14px;
      border-radius: 20px;
      border: 1px solid #ccc;
    }

    .search-inline button {
      border: none;
      background: #6f42c1;
      color: #fff;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
    }

    .tabs {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin: 16px 0;
      border-bottom: 1px solid #eee;
    }

    .tab {
      padding: 8px 12px;
      cursor: pointer;
      color: #666;
      font-weight: 500;
    }

    .tab.active {
      color: #1b9c48;
      border-bottom: 2px solid #1b9c48;
    }

    .results {
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    .panel {
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .panel h3 {
      margin: 0 0 8px;
    }

    .panel p {
      margin: 0;
      color: #555;
    }
  </style>
</head>

<body>

  <!-- üîç BARRA SUPERIOR -->
  <div class="top-bar">
    <div class="search-inline">
      <input id="campoBusca" type="text" />
      <button id="btnBuscar">üîç</button>
    </div>
  </div>

  <!-- üß≠ ABAS -->
  <nav class="abas">
  <button class="aba" onclick="irParaAba('tudo')">Tudo</button>
  <button class="aba" onclick="irParaAba('imagens')">Imagens</button>
  <button class="aba" onclick="irParaAba('videos')">V√≠deos</button>
  <button class="aba" onclick="irParaAba('noticias')">Not√≠cias</button>
</nav>
  <!-- üìÑ RESULTADOS -->
  <div class="results" id="areaResultados"></div>

  <!-- üß† SCRIPT -->
<script>
document.addEventListener("DOMContentLoaded", () => {

  const params = new URLSearchParams(window.location.search);
  let termo = params.get("q") || "";
  let abaAtual = params.get("aba") || "tudo";

  const campoBusca = document.getElementById("campoBusca");
  const lista = document.getElementById("lista-resultados");

  campoBusca.value = termo;

  function atualizarURL() {
    const url = `resultados.html?q=${encodeURIComponent(termo)}&aba=${abaAtual}`;
    history.replaceState(null, "", url);
  }

  function ativarAba() {
    document.querySelectorAll(".aba").forEach(btn => {
      btn.classList.toggle(
        "ativa",
        btn.textContent.toLowerCase() === abaAtual
      );
    });
  }

  async function buscarResultados() {
    if (!termo) return;

    const res = await fetch("index.json");
    const dados = await res.json();

    lista.innerHTML = "";

    const filtrados = dados.filter(item =>
      item.titulo.toLowerCase().includes(termo.toLowerCase()) ||
      item.descricao.toLowerCase().includes(termo.toLowerCase()) ||
      item.categoria.toLowerCase().includes(termo.toLowerCase())
    );

    if (!filtrados.length) {
      lista.innerHTML = "<p>Nenhum resultado encontrado.</p>";
      return;
    }

    filtrados.forEach(item => {
      const div = document.createElement("div");
      div.className = "resultado";
      div.innerHTML = `
        <a href="${item.link}" class="titulo-link">
          <h3>${item.titulo}</h3>
        </a>
        <small>${item.link}</small>
        <p>${item.descricao}</p>
      `;
      lista.appendChild(div);
    });
  }

  async function carregarPainel() {
    if (!termo) return;

    const res = await fetch("painel.json");
    const dados = await res.json();

    const item = dados.find(p =>
      p.titulo.toLowerCase() === termo.toLowerCase()
    );

    if (!item) return;

    document.getElementById("tituloPainel").textContent = item.titulo;
    document.getElementById("categoriaPainel").textContent = item.categoria || "";
    document.getElementById("descricaoPainel").textContent = item.descricao;

    const imagens = document.getElementById("imagensPainel");
    imagens.innerHTML = "";
    item.imagens.forEach(src => {
      const img = document.createElement("img");
      img.src = src;
      imagens.appendChild(img);
    });
  }

  document.getElementById("botaoBusca").onclick = () => {
    termo = campoBusca.value.trim();
    abaAtual = "tudo";
    atualizarURL();
    ativarAba();
    buscarResultados();
    carregarPainel();
  };

  campoBusca.addEventListener("keypress", e => {
    if (e.key === "Enter") {
      termo = campoBusca.value.trim();
      abaAtual = "tudo";
      atualizarURL();
      ativarAba();
      buscarResultados();
      carregarPainel();
    }
  });

  if (termo) {
    ativarAba();
    buscarResultados();
    carregarPainel();
  }

});
</script>

</body>
</html>
